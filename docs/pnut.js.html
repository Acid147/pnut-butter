<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: pnut.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: pnut.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>require('es6-promise').polyfill();
require('isomorphic-fetch');

const users = require('./users');
const posts = require('./posts');
const channels = require('./channels');
const messages = require('./messages');
const system = require('./system');

/**
 * pnut-butter.js
 *
 * Wrapper library for the pnut.io API.
 *
 * @returns {Object}
 */
const pnut = () => {

  const api = {
    base: 'https://api.pnut.io/v0',
    token: '',

    request(endpoint, { httpMethod = 'GET', resultAs = 'json', data = {} } = {}) {
      let auth = {};
      if (this.token !== '') {
        auth = {
          "Authorization": `Bearer ${this.token}`
        };
      }

      let options = {
        method: httpMethod,
        headers: auth
      };

      if (httpMethod !== 'GET' &amp;&amp; Object.keys(data).length > 0) {
        options.body = JSON.stringify(data);
        options.headers['Content-Type'] = 'application/json';
      }

      const uri = `${this.base}${endpoint}`;
      return fetch(uri, options).then(function (response) {
        if (resultAs === 'response') {
          return response;
        } else {
          return response[resultAs]();
        }
      });
    }
  };

  return Object.assign(
    {
      /**
       * Set auth token.
       * @param {string} newToken - API access token
       */
      set token(newToken) {
        api.token = newToken;
      },

      /**
       * Send request with custom endpoint / parameters.
       * @param {string} endpoint - The custom call
       * @param {string} method - HTTP verb, defaults to GET
       * @return {Promise}
       */
      custom(endpoint, method = 'GET', data = {}) {
        endpoint = endpoint.startsWith('/') ? `${endpoint}` : `/${endpoint}`;
        return api.request(`${endpoint}`, { httpMethod: method, data: data });
      },

      /**
      * Generate a URL for client side authentication.
      * @param {string} - Client ID token
      * @param {string} redirectURI - URI you want to be redirected at
      * @param {Object} [scope] - The scope you want to request
      * @returns {string} - A ready-to-use authentication url
      */
      authenticateClientURL(clientId = '', redirectURI = '', scope = {
        basic: true,
        stream: true,
        write_post: true,
        follow: true,
        update_profile: true,
        presence: true,
        messages: true,
        public_messages: true,
      }) {

        if (clientId.length &lt; 1) {
          throw new Error('You need a client ID for this request');
        } else if (redirectURI.length &lt; 1) {
          throw new Error('You need a redirect URI for this request');
        }

        let url = `https://pnut.io/oauth/authenticate?`;
        url += `client_id=${clientId}`;
        url += `&amp;redirect_uri=${redirectURI}`;
        url += `&amp;scope=${Object.keys(scope).join(',')}`;
        url += `&amp;response_type=token`;

        return url;
      },
    },

    users(api),
    posts(api),
    channels(api),
    messages(api),
    system(api)
  );
};

module.exports = pnut();</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-channels.html">channels</a></li><li><a href="module-messages.html">messages</a></li><li><a href="module-posts.html">posts</a></li><li><a href="module-system.html">system</a></li><li><a href="module-users.html">users</a></li></ul><h3>Global</h3><ul><li><a href="global.html#authenticateClientURL">authenticateClientURL</a></li><li><a href="global.html#custom">custom</a></li><li><a href="global.html#pnut">pnut</a></li><li><a href="global.html#token">token</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.3</a> on Sun Apr 02 2017 21:20:57 GMT+0200 (CEST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
